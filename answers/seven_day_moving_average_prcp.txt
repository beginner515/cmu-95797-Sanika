D SELECT
>   DATE,
>   PRCP,
>   (
>     COALESCE(CAST(LAG(PRCP, 3) OVER (ORDER BY DATE) AS DOUBLE), 0) +
>     COALESCE(CAST(LAG(PRCP, 2) OVER (ORDER BY DATE) AS DOUBLE), 0) +
>     COALESCE(CAST(LAG(PRCP, 1) OVER (ORDER BY DATE) AS DOUBLE), 0) +
>     COALESCE(CAST(PRCP AS DOUBLE), 0) +
>     COALESCE(CAST(LEAD(PRCP, 1) OVER (ORDER BY DATE) AS DOUBLE), 0) +
>     COALESCE(CAST(LEAD(PRCP, 2) OVER (ORDER BY DATE) AS DOUBLE), 0) +
>     COALESCE(CAST(LEAD(PRCP, 3) OVER (ORDER BY DATE) AS DOUBLE), 0)
>   ) / 7 AS seven_day_moving_avg_prcp
> FROM central_park_weather
> ORDER BY DATE;
┌────────────┬─────────┬───────────────────────────┐
│    DATE    │  PRCP   │ seven_day_moving_avg_prcp │
│  varchar   │ varchar │          double           │
├────────────┼─────────┼───────────────────────────┤
│ 2013-07-01 │ 0.84    │       0.20714285714285713 │
│ 2013-07-02 │ 0.08    │       0.20714285714285713 │
│ 2013-07-03 │ 0.53    │       0.20714285714285713 │
│ 2013-07-04 │ 0.00    │       0.20714285714285713 │
│ 2013-07-05 │ 0.00    │       0.11857142857142856 │
│ 2013-07-06 │ 0.00    │       0.13999999999999999 │
│ 2013-07-07 │ 0.00    │        0.0642857142857143 │
│ 2013-07-08 │ 0.22    │        0.0642857142857143 │
│ 2013-07-09 │ 0.23    │       0.09999999999999999 │
│ 2013-07-10 │ 0.00    │       0.10857142857142857 │
│ 2013-07-11 │ 0.00    │       0.10857142857142857 │
│ 2013-07-12 │ 0.25    │       0.07714285714285715 │
│ 2013-07-13 │ 0.06    │       0.04428571428571428 │
│ 2013-07-14 │ 0.00    │       0.04428571428571428 │
│ 2013-07-15 │ 0.00    │       0.04428571428571428 │
│ 2013-07-16 │ 0.00    │      0.008571428571428572 │
│ 2013-07-17 │ 0.00    │                       0.0 │
│ 2013-07-18 │ 0.00    │                       0.0 │
│ 2013-07-19 │ 0.00    │      0.008571428571428572 │
│ 2013-07-20 │ 0.00    │       0.05285714285714286 │
│     ·      │  ·      │                 ·         │
│     ·      │  ·      │                 ·         │
│     ·      │  ·      │                 ·         │
│ 2021-08-12 │ 0.00    │        0.1442857142857143 │
│ 2021-08-13 │ 0.00    │        0.1442857142857143 │
│ 2021-08-14 │ 0.00    │      0.025714285714285714 │
│ 2021-08-15 │ 0.00    │                       0.0 │
│ 2021-08-16 │ 0.00    │      0.028571428571428574 │
│ 2021-08-17 │ 0.00    │      0.028571428571428574 │
│ 2021-08-18 │ 0.00    │        0.6642857142857144 │
│ 2021-08-19 │ 0.20    │        1.0457142857142858 │
│ 2021-08-20 │ 0.00    │        1.1985714285714286 │
│ 2021-08-21 │ 4.45    │        1.1985714285714286 │
│ 2021-08-22 │ 2.67    │        1.1985714285714286 │
│ 2021-08-23 │ 1.07    │                      1.17 │
│ 2021-08-24 │ 0.00    │        1.2657142857142856 │
│ 2021-08-25 │ 0.00    │                      0.63 │
│ 2021-08-26 │ 0.00    │        0.2485714285714286 │
│ 2021-08-27 │ 0.67    │       0.09571428571428572 │
│ 2021-08-28 │ 0.00    │       0.09571428571428572 │
│ 2021-08-29 │ 0.00    │       0.09571428571428572 │
│ 2021-08-30 │ 0.00    │       0.09571428571428572 │
│ 2021-08-31 │ 0.00    │                       0.0 │
├────────────┴─────────┴───────────────────────────┤
│ 2984 rows (40 shown)                   3 columns │
└──────────────────────────────────────────────────┘